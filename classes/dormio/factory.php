<?class Dormio_Factory {  static $_cache = array();  static $instance_count = 0;  static $instances = array();    function __construct(PDO $db) {    $this->db = $db;    $this->dialect = Dormio_Dialect::factory($db->getAttribute(PDO::ATTR_DRIVER_NAME));    self::$instance_count++;  }    /**  *   */  function instance($which='default') {    if(!isset(self::$instances[$which])) {      $db = Dormio_Connection::instance($which);      self::$instances[$which] = new Dormio_Factory($db);    }    return self::$instances[$which];  }    function get($model, $pk=null) {    if(!class_exists($model)) throw new Dormio_Exception('No such model: ' . $model);    $obj = new $model($this->db, $this->dialect);    if($pk) $obj->load($pk);    return $obj;  }    function manager($name) {    if(!isset(self::$_cache[$name])) self::$_cache[$name] = new Dormio_Manager($name, $this->db, $this->dialect);    return self::$_cache[$name];  }}?>